# 线段与圆垂线功能实现

## 背景
对比Python版本，发现C++版本缺少线段与圆的垂线功能。需要实现：同时选中圆和两点生成的线段，右键点击显示"线段与圆"选项，产生圆周到线段的垂线，样式与已实现的"直线与圆"相同。

## 实现计划

### 步骤1：分析现有右键菜单逻辑
- 文件：`src/PaintingOverlay.cpp`
- 函数：`contextMenuEvent`
- 目标：理解现有的选择组合检测机制

### 步骤2：添加线段与圆的组合检测
- 文件：`src/PaintingOverlay.cpp`  
- 位置：`contextMenuEvent`函数中的菜单项添加逻辑
- 操作：添加线段+圆的组合检测和菜单项

### 步骤3：实现线段与圆关系测量逻辑
- 文件：`src/PaintingOverlay.cpp`
- 函数：`performComplexMeasurement`
- 操作：添加"线段与圆关系"和"线段与精细圆关系"的处理分支
- 逻辑：
  - 计算线段到圆心的最短距离
  - 找到线段上距离圆心最近的点（垂足）
  - 如果垂足不在线段上，找到线段端点中距离圆心最近的点
  - 计算圆周上对应的垂足点
  - 绘制垂线段（样式与直线与圆相同）

### 步骤4：添加线段到圆的距离计算辅助函数
- 文件：`src/PaintingOverlay.cpp`
- 函数：新增`calculateLineSegmentToCircleDistance`
- 功能：计算线段到圆周的最短距离，处理垂足在线段外的情况

### 步骤5：更新头文件声明
- 文件：`src/PaintingOverlay.h`
- 操作：添加新函数的声明

## 预期结果
- 同时选中线段和圆后，右键菜单显示"线段与圆"选项
- 点击后绘制红色虚线垂线，样式与现有"直线与圆"一致
- 正确处理垂足不在线段上的特殊情况

## 技术要点
- 复用现有的几何计算函数
- 保持与"直线与圆"相同的绘制样式
- 特殊情况：垂足不在线段上时仍绘制垂线
